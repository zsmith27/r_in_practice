---
title: "Untitled"
author: "Zachary M. Smith"
date: "September 23, 2018"
output: html_document
---

# Data Management

## Small Data Sets

If the data set(s) are small, then the data should be stored within the R project folder and can be published to shinyapps.io along with the rest of the files necessary to run the app. 

##	Large Data Sets

If the data set(s) are large or expected to grow, then the data should be stored in a cloud database. Large data files will be rejected from shinyapps.io. Use the following link as a more comprehensive description of how to work with databases in shiny (https://shiny.rstudio.com/articles/overview.html).

Shinyapps.io is intended to host the code associated with the app, not the data associated with the app. A cloud-based database can be used to store data and the shiny app can reference this data. The database cannot be hosted from your local computer because once the app is published on shinyapps.io it will not be able to access your local files or databases. If the database structure does not change, any additional data appended to the database will be automatically accessible through the shiny app without the need to modify any of the shiny app code.

## Creating and Managing a Cloud Database

This section is technically independent of shiny but you will need to follow these steps to set up a cloud database. 

### Connecting to a Cloud Based Database

To establish a connection with a database, use the pool package (https://shiny.rstudio.com/articles/pool-basics.html). The pool package aids in the management of database queries, which can be complicated. Below is an example of how to use the pool package function dbPool. You will need to indicate: driver class (drv; e.g., PostgreSQL), database name (dbname), database host (host), your database username (user), and your database password (password).
```{r, eval=FALSE}
pool <- pool::dbPool(drv = RPostgreSQL::PostgreSQL(),
                     dbname = "database_name",
                     host = "cpanel.example.org",
                     user = "smitty",
                     password = "example")
```

At the beginning of your server.R file you establish the connection to the link created by the pool package using the function poolCheckout.
```{r}
conn <- pool::poolCheckout(pool)
```

At the end of your server.R file you return the connection to the link created by the pool package using the function poolReturn.
```{r}
pool::poolReturn(conn)
```

These two functions should encapsulate all queries made to the database and help perform the necessary steps to prevent issues from occurring.
Within the sever.R file, you can then use the DBI package to query the database. For example, if you want to import a table from a database you can use the DBI function dbReadTable.
```{r}
new.object <- dbReadTable(conn, "table_name") 
```
